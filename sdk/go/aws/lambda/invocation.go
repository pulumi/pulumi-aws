// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package lambda

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-aws/sdk/v7/go/aws/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// Manages an AWS Lambda Function invocation. Use this resource to invoke a Lambda function with the [RequestResponse](https://docs.aws.amazon.com/lambda/latest/dg/API_Invoke.html#API_Invoke_RequestSyntax) invocation type.
//
// > **Note:** By default this resource _only_ invokes the function when the arguments call for a create or replace. After an initial invocation on _apply_, if the arguments do not change, a subsequent _apply_ does not invoke the function again. To dynamically invoke the function, see the `triggers` example below. To always invoke a function on each _apply_, see the `lambda.Invocation` data source. To invoke the Lambda function when the Pulumi resource is updated and deleted, see the CRUD Lifecycle Management example below.
//
// > **Note:** If you get a `KMSAccessDeniedException: Lambda was unable to decrypt the environment variables because KMS access was denied` error when invoking a Lambda function with environment variables, the IAM role associated with the function may have been deleted and recreated after the function was created. You can fix the problem two ways: 1) updating the function's role to another role and then updating it back again to the recreated role. (When you create a function, Lambda grants permissions on the KMS key to the function's IAM role. If the IAM role is recreated, the grant is no longer valid. Changing the function's role or recreating the function causes Lambda to update the grant.)
//
// ## Example Usage
//
// ### Basic Invocation
//
// ```go
// package main
//
// import (
//
//	"encoding/json"
//
//	"github.com/pulumi/pulumi-aws/sdk/v7/go/aws/lambda"
//	"github.com/pulumi/pulumi-std/sdk/go/std"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
// func main() {
// pulumi.Run(func(ctx *pulumi.Context) error {
// // Lambda function to invoke
// example, err := lambda.NewFunction(ctx, "example", &lambda.FunctionArgs{
// Code: pulumi.NewFileArchive("function.zip"),
// Name: pulumi.String("data_processor"),
// Role: pulumi.Any(lambdaRole.Arn),
// Handler: pulumi.String("index.handler"),
// Runtime: pulumi.String(lambda.RuntimePython3d12),
// })
// if err != nil {
// return err
// }
// tmpJSON0, err := json.Marshal(map[string]interface{}{
// "operation": "initialize",
// "config": map[string]interface{}{
// "environment": "production",
// "debug": false,
// },
// })
// if err != nil {
// return err
// }
// json0 := string(tmpJSON0)
// // Invoke the function once during resource creation
// exampleInvocation, err := lambda.NewInvocation(ctx, "example", &lambda.InvocationArgs{
// FunctionName: example.Name,
// Input: pulumi.String(json0),
// })
// if err != nil {
// return err
// }
// ctx.Export("initializationResult", std.JsondecodeOutput(ctx, std.JsondecodeOutputArgs{
// Input: exampleInvocation.Result,
// }, nil).ApplyT(func(invoke std.JsondecodeResult) (*interface{}, error) {
// return invoke.Result.Status, nil
// }).(pulumi.Interface{}PtrOutput))
// return nil
// })
// }
// ```
//
// ### Dynamic Invocation with Triggers
//
// ```go
// package main
//
// import (
//
//	"encoding/json"
//
//	"github.com/pulumi/pulumi-aws/sdk/v7/go/aws/lambda"
//	"github.com/pulumi/pulumi-std/sdk/go/std"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			tmpJSON0, err := json.Marshal(map[string]interface{}{
//				"environment": environment,
//				"timestamp":   std.Timestamp(ctx, &std.TimestampArgs{}, nil).Result,
//			})
//			if err != nil {
//				return err
//			}
//			json0 := string(tmpJSON0)
//			tmpJSON1, err := json.Marshal(map[string]interface{}{
//				"operation":   "process_data",
//				"environment": environment,
//				"batch_id":    batchId.Result,
//			})
//			if err != nil {
//				return err
//			}
//			json1 := string(tmpJSON1)
//			_, err = lambda.NewInvocation(ctx, "example", &lambda.InvocationArgs{
//				FunctionName: pulumi.Any(exampleAwsLambdaFunction.FunctionName),
//				Triggers: pulumi.StringMap{
//					"function_version": pulumi.Any(exampleAwsLambdaFunction.Version),
//					"config_hash": pulumi.String(std.Sha256Output(ctx, std.Sha256OutputArgs{
//						Input: pulumi.String(json0),
//					}, nil).ApplyT(func(invoke std.Sha256Result) (*string, error) {
//						return invoke.Result, nil
//					}).(pulumi.StringPtrOutput)),
//				},
//				Input: pulumi.String(json1),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ### CRUD Lifecycle Management
//
// ```go
// package main
//
// import (
//
//	"encoding/json"
//
//	"github.com/pulumi/pulumi-aws/sdk/v7/go/aws/lambda"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			tmpJSON0, err := json.Marshal(map[string]interface{}{
//				"resource_name": "database_setup",
//				"database_url":  exampleAwsDbInstance.Endpoint,
//				"credentials": map[string]interface{}{
//					"username": dbUsername,
//					"password": dbPassword,
//				},
//			})
//			if err != nil {
//				return err
//			}
//			json0 := string(tmpJSON0)
//			_, err = lambda.NewInvocation(ctx, "example", &lambda.InvocationArgs{
//				FunctionName:   pulumi.Any(exampleAwsLambdaFunction.FunctionName),
//				Input:          pulumi.String(json0),
//				LifecycleScope: pulumi.String("CRUD"),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// > **Note:** `lifecycleScope = "CRUD"` will inject a key `tf` in the input event to pass lifecycle information! This allows the Lambda function to handle different lifecycle transitions uniquely. If you need to use a key `tf` in your own input JSON, the default key name can be overridden with the `pulumiKey` argument.
//
// The lifecycle key gets added with subkeys:
//
// * `action` - Action Pulumi performs on the resource. Values are `create`, `update`, or `delete`.
// * `prevInput` - Input JSON payload from the previous invocation. This can be used to handle update and delete events.
//
// When the resource from the CRUD example above is created, the Lambda will receive the following JSON payload:
//
// If the `databaseUrl` changes, the Lambda will be invoked again with:
//
// When the invocation resource is removed, the final invocation will have:
//
// ## Import
//
// Using `pulumi import`, import Lambda Invocation using the `function_name,qualifier,result_hash`. For example:
//
// ```sh
// $ pulumi import aws:lambda/invocation:Invocation test_lambda my_test_lambda_function,$LATEST,b326b5062b2f0e69046810717534cb09
// ```
// Because it is not possible to retrieve previous invocations, during the next apply `terraform` will update the resource calling again the function.
// To compute the `result_hash`, it is necessary to hash it with the standard `md5` hash function.
type Invocation struct {
	pulumi.CustomResourceState

	// Name of the Lambda function.
	FunctionName pulumi.StringOutput `pulumi:"functionName"`
	// JSON payload to the Lambda function.
	//
	// The following arguments are optional:
	Input pulumi.StringOutput `pulumi:"input"`
	// Lifecycle scope of the resource to manage. Valid values are `CREATE_ONLY` and `CRUD`. Defaults to `CREATE_ONLY`. `CREATE_ONLY` will invoke the function only on creation or replacement. `CRUD` will invoke the function on each lifecycle event, and augment the input JSON payload with additional lifecycle information.
	LifecycleScope pulumi.StringPtrOutput `pulumi:"lifecycleScope"`
	// Qualifier (i.e., version) of the Lambda function. Defaults to `$LATEST`.
	Qualifier pulumi.StringPtrOutput `pulumi:"qualifier"`
	// Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the provider configuration.
	Region pulumi.StringOutput `pulumi:"region"`
	// String result of the Lambda function invocation.
	Result       pulumi.StringOutput    `pulumi:"result"`
	TerraformKey pulumi.StringPtrOutput `pulumi:"terraformKey"`
	// Map of arbitrary keys and values that, when changed, will trigger a re-invocation.
	Triggers pulumi.StringMapOutput `pulumi:"triggers"`
}

// NewInvocation registers a new resource with the given unique name, arguments, and options.
func NewInvocation(ctx *pulumi.Context,
	name string, args *InvocationArgs, opts ...pulumi.ResourceOption) (*Invocation, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.FunctionName == nil {
		return nil, errors.New("invalid value for required argument 'FunctionName'")
	}
	if args.Input == nil {
		return nil, errors.New("invalid value for required argument 'Input'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource Invocation
	err := ctx.RegisterResource("aws:lambda/invocation:Invocation", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetInvocation gets an existing Invocation resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetInvocation(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *InvocationState, opts ...pulumi.ResourceOption) (*Invocation, error) {
	var resource Invocation
	err := ctx.ReadResource("aws:lambda/invocation:Invocation", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering Invocation resources.
type invocationState struct {
	// Name of the Lambda function.
	FunctionName *string `pulumi:"functionName"`
	// JSON payload to the Lambda function.
	//
	// The following arguments are optional:
	Input *string `pulumi:"input"`
	// Lifecycle scope of the resource to manage. Valid values are `CREATE_ONLY` and `CRUD`. Defaults to `CREATE_ONLY`. `CREATE_ONLY` will invoke the function only on creation or replacement. `CRUD` will invoke the function on each lifecycle event, and augment the input JSON payload with additional lifecycle information.
	LifecycleScope *string `pulumi:"lifecycleScope"`
	// Qualifier (i.e., version) of the Lambda function. Defaults to `$LATEST`.
	Qualifier *string `pulumi:"qualifier"`
	// Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the provider configuration.
	Region *string `pulumi:"region"`
	// String result of the Lambda function invocation.
	Result       *string `pulumi:"result"`
	TerraformKey *string `pulumi:"terraformKey"`
	// Map of arbitrary keys and values that, when changed, will trigger a re-invocation.
	Triggers map[string]string `pulumi:"triggers"`
}

type InvocationState struct {
	// Name of the Lambda function.
	FunctionName pulumi.StringPtrInput
	// JSON payload to the Lambda function.
	//
	// The following arguments are optional:
	Input pulumi.StringPtrInput
	// Lifecycle scope of the resource to manage. Valid values are `CREATE_ONLY` and `CRUD`. Defaults to `CREATE_ONLY`. `CREATE_ONLY` will invoke the function only on creation or replacement. `CRUD` will invoke the function on each lifecycle event, and augment the input JSON payload with additional lifecycle information.
	LifecycleScope pulumi.StringPtrInput
	// Qualifier (i.e., version) of the Lambda function. Defaults to `$LATEST`.
	Qualifier pulumi.StringPtrInput
	// Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the provider configuration.
	Region pulumi.StringPtrInput
	// String result of the Lambda function invocation.
	Result       pulumi.StringPtrInput
	TerraformKey pulumi.StringPtrInput
	// Map of arbitrary keys and values that, when changed, will trigger a re-invocation.
	Triggers pulumi.StringMapInput
}

func (InvocationState) ElementType() reflect.Type {
	return reflect.TypeOf((*invocationState)(nil)).Elem()
}

type invocationArgs struct {
	// Name of the Lambda function.
	FunctionName string `pulumi:"functionName"`
	// JSON payload to the Lambda function.
	//
	// The following arguments are optional:
	Input string `pulumi:"input"`
	// Lifecycle scope of the resource to manage. Valid values are `CREATE_ONLY` and `CRUD`. Defaults to `CREATE_ONLY`. `CREATE_ONLY` will invoke the function only on creation or replacement. `CRUD` will invoke the function on each lifecycle event, and augment the input JSON payload with additional lifecycle information.
	LifecycleScope *string `pulumi:"lifecycleScope"`
	// Qualifier (i.e., version) of the Lambda function. Defaults to `$LATEST`.
	Qualifier *string `pulumi:"qualifier"`
	// Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the provider configuration.
	Region       *string `pulumi:"region"`
	TerraformKey *string `pulumi:"terraformKey"`
	// Map of arbitrary keys and values that, when changed, will trigger a re-invocation.
	Triggers map[string]string `pulumi:"triggers"`
}

// The set of arguments for constructing a Invocation resource.
type InvocationArgs struct {
	// Name of the Lambda function.
	FunctionName pulumi.StringInput
	// JSON payload to the Lambda function.
	//
	// The following arguments are optional:
	Input pulumi.StringInput
	// Lifecycle scope of the resource to manage. Valid values are `CREATE_ONLY` and `CRUD`. Defaults to `CREATE_ONLY`. `CREATE_ONLY` will invoke the function only on creation or replacement. `CRUD` will invoke the function on each lifecycle event, and augment the input JSON payload with additional lifecycle information.
	LifecycleScope pulumi.StringPtrInput
	// Qualifier (i.e., version) of the Lambda function. Defaults to `$LATEST`.
	Qualifier pulumi.StringPtrInput
	// Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the provider configuration.
	Region       pulumi.StringPtrInput
	TerraformKey pulumi.StringPtrInput
	// Map of arbitrary keys and values that, when changed, will trigger a re-invocation.
	Triggers pulumi.StringMapInput
}

func (InvocationArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*invocationArgs)(nil)).Elem()
}

type InvocationInput interface {
	pulumi.Input

	ToInvocationOutput() InvocationOutput
	ToInvocationOutputWithContext(ctx context.Context) InvocationOutput
}

func (*Invocation) ElementType() reflect.Type {
	return reflect.TypeOf((**Invocation)(nil)).Elem()
}

func (i *Invocation) ToInvocationOutput() InvocationOutput {
	return i.ToInvocationOutputWithContext(context.Background())
}

func (i *Invocation) ToInvocationOutputWithContext(ctx context.Context) InvocationOutput {
	return pulumi.ToOutputWithContext(ctx, i).(InvocationOutput)
}

// InvocationArrayInput is an input type that accepts InvocationArray and InvocationArrayOutput values.
// You can construct a concrete instance of `InvocationArrayInput` via:
//
//	InvocationArray{ InvocationArgs{...} }
type InvocationArrayInput interface {
	pulumi.Input

	ToInvocationArrayOutput() InvocationArrayOutput
	ToInvocationArrayOutputWithContext(context.Context) InvocationArrayOutput
}

type InvocationArray []InvocationInput

func (InvocationArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Invocation)(nil)).Elem()
}

func (i InvocationArray) ToInvocationArrayOutput() InvocationArrayOutput {
	return i.ToInvocationArrayOutputWithContext(context.Background())
}

func (i InvocationArray) ToInvocationArrayOutputWithContext(ctx context.Context) InvocationArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(InvocationArrayOutput)
}

// InvocationMapInput is an input type that accepts InvocationMap and InvocationMapOutput values.
// You can construct a concrete instance of `InvocationMapInput` via:
//
//	InvocationMap{ "key": InvocationArgs{...} }
type InvocationMapInput interface {
	pulumi.Input

	ToInvocationMapOutput() InvocationMapOutput
	ToInvocationMapOutputWithContext(context.Context) InvocationMapOutput
}

type InvocationMap map[string]InvocationInput

func (InvocationMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Invocation)(nil)).Elem()
}

func (i InvocationMap) ToInvocationMapOutput() InvocationMapOutput {
	return i.ToInvocationMapOutputWithContext(context.Background())
}

func (i InvocationMap) ToInvocationMapOutputWithContext(ctx context.Context) InvocationMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(InvocationMapOutput)
}

type InvocationOutput struct{ *pulumi.OutputState }

func (InvocationOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**Invocation)(nil)).Elem()
}

func (o InvocationOutput) ToInvocationOutput() InvocationOutput {
	return o
}

func (o InvocationOutput) ToInvocationOutputWithContext(ctx context.Context) InvocationOutput {
	return o
}

// Name of the Lambda function.
func (o InvocationOutput) FunctionName() pulumi.StringOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringOutput { return v.FunctionName }).(pulumi.StringOutput)
}

// JSON payload to the Lambda function.
//
// The following arguments are optional:
func (o InvocationOutput) Input() pulumi.StringOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringOutput { return v.Input }).(pulumi.StringOutput)
}

// Lifecycle scope of the resource to manage. Valid values are `CREATE_ONLY` and `CRUD`. Defaults to `CREATE_ONLY`. `CREATE_ONLY` will invoke the function only on creation or replacement. `CRUD` will invoke the function on each lifecycle event, and augment the input JSON payload with additional lifecycle information.
func (o InvocationOutput) LifecycleScope() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringPtrOutput { return v.LifecycleScope }).(pulumi.StringPtrOutput)
}

// Qualifier (i.e., version) of the Lambda function. Defaults to `$LATEST`.
func (o InvocationOutput) Qualifier() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringPtrOutput { return v.Qualifier }).(pulumi.StringPtrOutput)
}

// Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the provider configuration.
func (o InvocationOutput) Region() pulumi.StringOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringOutput { return v.Region }).(pulumi.StringOutput)
}

// String result of the Lambda function invocation.
func (o InvocationOutput) Result() pulumi.StringOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringOutput { return v.Result }).(pulumi.StringOutput)
}

func (o InvocationOutput) TerraformKey() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringPtrOutput { return v.TerraformKey }).(pulumi.StringPtrOutput)
}

// Map of arbitrary keys and values that, when changed, will trigger a re-invocation.
func (o InvocationOutput) Triggers() pulumi.StringMapOutput {
	return o.ApplyT(func(v *Invocation) pulumi.StringMapOutput { return v.Triggers }).(pulumi.StringMapOutput)
}

type InvocationArrayOutput struct{ *pulumi.OutputState }

func (InvocationArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Invocation)(nil)).Elem()
}

func (o InvocationArrayOutput) ToInvocationArrayOutput() InvocationArrayOutput {
	return o
}

func (o InvocationArrayOutput) ToInvocationArrayOutputWithContext(ctx context.Context) InvocationArrayOutput {
	return o
}

func (o InvocationArrayOutput) Index(i pulumi.IntInput) InvocationOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *Invocation {
		return vs[0].([]*Invocation)[vs[1].(int)]
	}).(InvocationOutput)
}

type InvocationMapOutput struct{ *pulumi.OutputState }

func (InvocationMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Invocation)(nil)).Elem()
}

func (o InvocationMapOutput) ToInvocationMapOutput() InvocationMapOutput {
	return o
}

func (o InvocationMapOutput) ToInvocationMapOutputWithContext(ctx context.Context) InvocationMapOutput {
	return o
}

func (o InvocationMapOutput) MapIndex(k pulumi.StringInput) InvocationOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *Invocation {
		return vs[0].(map[string]*Invocation)[vs[1].(string)]
	}).(InvocationOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*InvocationInput)(nil)).Elem(), &Invocation{})
	pulumi.RegisterInputType(reflect.TypeOf((*InvocationArrayInput)(nil)).Elem(), InvocationArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*InvocationMapInput)(nil)).Elem(), InvocationMap{})
	pulumi.RegisterOutputType(InvocationOutput{})
	pulumi.RegisterOutputType(InvocationArrayOutput{})
	pulumi.RegisterOutputType(InvocationMapOutput{})
}
